{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import{Card,Spin,Alert,Button,Typography}from'antd';import{PlayCircleOutlined,ReloadOutlined,WarningOutlined}from'@ant-design/icons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Text}=Typography;const CameraStream=_ref=>{let{camera,streamUrl,quality,onStatusUpdate}=_ref;const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[stats,setStats]=useState({});const videoRef=useRef(null);useEffect(()=>{if(camera&&streamUrl){loadStream();}},[camera,streamUrl,quality]);const loadStream=async()=>{setLoading(true);setError(null);try{// 模拟流加载\nawait new Promise(resolve=>setTimeout(resolve,1000));// 模拟流统计\nconst mockStats={bitrate:Math.floor(Math.random()*3000)+1000,framerate:25,resolution:quality==='1080p'?'1920x1080':quality==='720p'?'1280x720':'640x480',latency:Math.floor(Math.random()*100)+50};setStats(mockStats);onStatusUpdate&&onStatusUpdate(camera.id,'connected',mockStats);setLoading(false);}catch(err){setError('Failed to load video stream');setLoading(false);onStatusUpdate&&onStatusUpdate(camera.id,'error',null);}};const handleRetry=()=>{loadStream();};if(loading){return/*#__PURE__*/_jsx(Card,{className:\"video-stream-card\",style:{height:'100%',minHeight:'200px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100%',flexDirection:'column'},children:[/*#__PURE__*/_jsx(Spin,{size:\"large\"}),/*#__PURE__*/_jsx(Text,{style:{marginTop:'16px'},children:\"\\u52A0\\u8F7D\\u89C6\\u9891\\u6D41...\"})]})});}if(error){return/*#__PURE__*/_jsx(Card,{className:\"video-stream-card error\",style:{height:'100%',minHeight:'200px'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100%',flexDirection:'column'},children:[/*#__PURE__*/_jsx(WarningOutlined,{style:{fontSize:'48px',color:'#ff4d4f',marginBottom:'16px'}}),/*#__PURE__*/_jsx(Alert,{message:\"\\u89C6\\u9891\\u6D41\\u52A0\\u8F7D\\u5931\\u8D25\",description:error,type:\"error\",showIcon:false,style:{marginBottom:'16px'}}),/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(ReloadOutlined,{}),onClick:handleRetry,children:\"\\u91CD\\u8BD5\"})]})});}return/*#__PURE__*/_jsx(Card,{className:\"video-stream-card\",style:{height:'100%',minHeight:'200px'},title:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"span\",{children:camera.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#666'},children:[stats.resolution,\" | \",stats.bitrate,\"kbps | \",stats.latency,\"ms\"]})]}),size:\"small\",children:/*#__PURE__*/_jsx(\"div\",{className:\"video-container\",style:{position:'relative',width:'100%',height:'200px',backgroundColor:'#000',display:'flex',alignItems:'center',justifyContent:'center',borderRadius:'6px',overflow:'hidden'},children:/*#__PURE__*/_jsxs(\"div\",{style:{width:'100%',height:'100%',background:'linear-gradient(45deg, #1a1a1a 25%, transparent 25%), linear-gradient(-45deg, #1a1a1a 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #1a1a1a 75%), linear-gradient(-45deg, transparent 75%, #1a1a1a 75%)',backgroundSize:'20px 20px',backgroundPosition:'0 0, 0 10px, 10px -10px, -10px 0px',display:'flex',alignItems:'center',justifyContent:'center',position:'relative'},children:[/*#__PURE__*/_jsx(PlayCircleOutlined,{style:{fontSize:'48px',color:'#1890ff',opacity:0.8}}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'8px',left:'8px',background:'rgba(0,0,0,0.7)',color:'white',padding:'2px 8px',borderRadius:'4px',fontSize:'12px'},children:\"LIVE\"}),/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',bottom:'8px',right:'8px',background:'rgba(0,0,0,0.7)',color:'white',padding:'2px 8px',borderRadius:'4px',fontSize:'12px'},children:[stats.framerate,\"fps\"]})]})})});};export default CameraStream;","map":{"version":3,"names":["React","useEffect","useRef","useState","Card","Spin","Alert","Button","Typography","PlayCircleOutlined","ReloadOutlined","WarningOutlined","jsx","_jsx","jsxs","_jsxs","Text","CameraStream","_ref","camera","streamUrl","quality","onStatusUpdate","loading","setLoading","error","setError","stats","setStats","videoRef","loadStream","Promise","resolve","setTimeout","mockStats","bitrate","Math","floor","random","framerate","resolution","latency","id","err","handleRetry","className","style","height","minHeight","children","display","justifyContent","alignItems","flexDirection","size","marginTop","fontSize","color","marginBottom","message","description","type","showIcon","icon","onClick","title","name","position","width","backgroundColor","borderRadius","overflow","background","backgroundSize","backgroundPosition","opacity","top","left","padding","bottom","right"],"sources":["/Users/huborychen/Documents/my-workspace/aick-mmp/frontend/src/components/CameraStream.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { Card, Spin, Alert, Button, Typography } from 'antd';\nimport { PlayCircleOutlined, ReloadOutlined, WarningOutlined } from '@ant-design/icons';\n\nconst { Text } = Typography;\n\nconst CameraStream = ({ camera, streamUrl, quality, onStatusUpdate }) => {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [stats, setStats] = useState({});\n  const videoRef = useRef(null);\n\n  useEffect(() => {\n    if (camera && streamUrl) {\n      loadStream();\n    }\n  }, [camera, streamUrl, quality]);\n\n  const loadStream = async () => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      // 模拟流加载\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      // 模拟流统计\n      const mockStats = {\n        bitrate: Math.floor(Math.random() * 3000) + 1000,\n        framerate: 25,\n        resolution: quality === '1080p' ? '1920x1080' : quality === '720p' ? '1280x720' : '640x480',\n        latency: Math.floor(Math.random() * 100) + 50\n      };\n      \n      setStats(mockStats);\n      onStatusUpdate && onStatusUpdate(camera.id, 'connected', mockStats);\n      setLoading(false);\n    } catch (err) {\n      setError('Failed to load video stream');\n      setLoading(false);\n      onStatusUpdate && onStatusUpdate(camera.id, 'error', null);\n    }\n  };\n\n  const handleRetry = () => {\n    loadStream();\n  };\n\n  if (loading) {\n    return (\n      <Card className=\"video-stream-card\" style={{ height: '100%', minHeight: '200px' }}>\n        <div style={{ \n          display: 'flex', \n          justifyContent: 'center', \n          alignItems: 'center', \n          height: '100%',\n          flexDirection: 'column'\n        }}>\n          <Spin size=\"large\" />\n          <Text style={{ marginTop: '16px' }}>加载视频流...</Text>\n        </div>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card className=\"video-stream-card error\" style={{ height: '100%', minHeight: '200px' }}>\n        <div style={{ \n          display: 'flex', \n          justifyContent: 'center', \n          alignItems: 'center', \n          height: '100%',\n          flexDirection: 'column'\n        }}>\n          <WarningOutlined style={{ fontSize: '48px', color: '#ff4d4f', marginBottom: '16px' }} />\n          <Alert \n            message=\"视频流加载失败\" \n            description={error}\n            type=\"error\" \n            showIcon={false}\n            style={{ marginBottom: '16px' }}\n          />\n          <Button icon={<ReloadOutlined />} onClick={handleRetry}>\n            重试\n          </Button>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <Card \n      className=\"video-stream-card\"\n      style={{ height: '100%', minHeight: '200px' }}\n      title={\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n          <span>{camera.name}</span>\n          <div style={{ fontSize: '12px', color: '#666' }}>\n            {stats.resolution} | {stats.bitrate}kbps | {stats.latency}ms\n          </div>\n        </div>\n      }\n      size=\"small\"\n    >\n      <div \n        className=\"video-container\"\n        style={{ \n          position: 'relative',\n          width: '100%',\n          height: '200px',\n          backgroundColor: '#000',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          borderRadius: '6px',\n          overflow: 'hidden'\n        }}\n      >\n        {/* 模拟视频播放器 */}\n        <div style={{\n          width: '100%',\n          height: '100%',\n          background: 'linear-gradient(45deg, #1a1a1a 25%, transparent 25%), linear-gradient(-45deg, #1a1a1a 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #1a1a1a 75%), linear-gradient(-45deg, transparent 75%, #1a1a1a 75%)',\n          backgroundSize: '20px 20px',\n          backgroundPosition: '0 0, 0 10px, 10px -10px, -10px 0px',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          position: 'relative'\n        }}>\n          <PlayCircleOutlined style={{ fontSize: '48px', color: '#1890ff', opacity: 0.8 }} />\n          <div style={{\n            position: 'absolute',\n            top: '8px',\n            left: '8px',\n            background: 'rgba(0,0,0,0.7)',\n            color: 'white',\n            padding: '2px 8px',\n            borderRadius: '4px',\n            fontSize: '12px'\n          }}>\n            LIVE\n          </div>\n          <div style={{\n            position: 'absolute',\n            bottom: '8px',\n            right: '8px',\n            background: 'rgba(0,0,0,0.7)',\n            color: 'white',\n            padding: '2px 8px',\n            borderRadius: '4px',\n            fontSize: '12px'\n          }}>\n            {stats.framerate}fps\n          </div>\n        </div>\n      </div>\n    </Card>\n  );\n};\n\nexport default CameraStream;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}